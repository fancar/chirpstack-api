{
  "swagger": "2.0",
  "info": {
    "title": "as/external/api/handyrusty.proto",
    "version": "version not set"
  },
  "schemes": [
    "http",
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/api/handy-rusty/current-state": {
      "get": {
        "operationId": "GetCurrentState",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/hrGetCurrentStateResponse"
            }
          }
        },
        "tags": [
          "HandyRustyService"
        ]
      }
    },
    "/api/handy-rusty/frames/counters": {
      "post": {
        "summary": "GetFrameCounters returns frame counters by type for the given range. Aggregation: day",
        "operationId": "GetFrameCounters",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/hrGetFrameCountersResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/hrGetFrameCountersRequest"
            }
          }
        ],
        "tags": [
          "HandyRustyService"
        ]
      }
    },
    "/api/handy-rusty/frames/logs/device-frames": {
      "post": {
        "summary": "GetDeviceFramesLog returns an array with recieved and transmitted device's frames",
        "operationId": "GetDeviceFramesLog",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/hrGetDeviceFramesLogResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/hrGetDeviceFramesLogRequest"
            }
          }
        ],
        "tags": [
          "HandyRustyService"
        ]
      }
    },
    "/api/handy-rusty/frames/logs/device-frames/csv": {
      "get": {
        "summary": "StreamDeviceFramesLogCSV streams the frame-logs from handyrusty CH-storage.\n  * The data is transferred by chunks (stream);\n  * This endpoint does not work from a web-browser!",
        "operationId": "StreamDeviceFramesLogCSV",
        "responses": {
          "200": {
            "description": "A successful response.(streaming responses)",
            "schema": {
              "$ref": "#/x-stream-definitions/hrStreamDeviceFramesLogCSVResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "offset",
            "description": "you can specify offset (for pagination).",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "limit",
            "description": "you can specify rows limit.",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "start",
            "description": "You can specify start DateTime point. format RFC3339: 2006-01-02T15:04:05.000Z.",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "end",
            "description": "You can specify end DateTime point. format RFC3339: 2006-01-02T15:04:05.000Z.",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "organizationId",
            "description": "You can set the id to 0 if admin.",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "int64"
          },
          {
            "name": "timezone",
            "description": "here user sends his local timezone.",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "int64"
          },
          {
            "name": "gwOnly",
            "description": "for internal use. Will be ignored from external api.",
            "in": "query",
            "required": false,
            "type": "boolean",
            "format": "boolean"
          }
        ],
        "tags": [
          "HandyRustyService"
        ]
      }
    },
    "/api/handy-rusty/frames/speed": {
      "post": {
        "summary": "GetFrameSpeed returns an array with rx+tx frames per minute measurments",
        "operationId": "GetFrameSpeed",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/hrGetFrameSpeedResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/hrGetFrameSpeedRequest"
            }
          }
        ],
        "tags": [
          "HandyRustyService"
        ]
      }
    },
    "/api/handy-rusty/integration/replies": {
      "get": {
        "operationId": "GetIntegrationReplies",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/hrGetIntegrationRepliesResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "offset",
            "description": "you can specify offset (for pagination).",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "limit",
            "description": "you can specify rows limit.",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "organisationId",
            "description": "id of organization where integration linked to.",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "int64"
          },
          {
            "name": "routingProfileId",
            "description": "id of routing profile.",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "int64"
          },
          {
            "name": "start",
            "description": "You can specify start DateTime point.",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "date-time"
          },
          {
            "name": "end",
            "description": "You can specify end DateTime point.",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "date-time"
          }
        ],
        "tags": [
          "HandyRustyService"
        ]
      }
    },
    "/api/handy-rusty/rc/exec-command": {
      "post": {
        "summary": "ExecCommand sends the command to execute on gw. It waits 30 sec for an answer from gw",
        "operationId": "ExecCommand",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/gwGatewayCommandExecResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/hrExecCommandRequest"
            }
          }
        ],
        "tags": [
          "HandyRustyService"
        ]
      }
    }
  },
  "definitions": {
    "commonLocation": {
      "type": "object",
      "properties": {
        "latitude": {
          "type": "number",
          "format": "double",
          "description": "Latitude."
        },
        "longitude": {
          "type": "number",
          "format": "double",
          "description": "Longitude."
        },
        "altitude": {
          "type": "number",
          "format": "double",
          "description": "Altitude."
        },
        "source": {
          "$ref": "#/definitions/commonLocationSource",
          "description": "Location source."
        },
        "accuracy": {
          "type": "integer",
          "format": "int64",
          "description": "Accuracy (in meters)."
        }
      }
    },
    "commonLocationSource": {
      "type": "string",
      "enum": [
        "UNKNOWN",
        "GPS",
        "CONFIG",
        "GEO_RESOLVER_TDOA",
        "GEO_RESOLVER_RSSI",
        "GEO_RESOLVER_GNSS",
        "GEO_RESOLVER_WIFI"
      ],
      "default": "UNKNOWN",
      "description": " - UNKNOWN: Unknown.\n - GPS: GPS.\n - CONFIG: Manually configured.\n - GEO_RESOLVER_TDOA: Geo resolver (TDOA).\n - GEO_RESOLVER_RSSI: Geo resolver (RSSI).\n - GEO_RESOLVER_GNSS: Geo resolver (GNSS).\n - GEO_RESOLVER_WIFI: Geo resolver (WIFI)."
    },
    "gwFineTimestampType": {
      "type": "string",
      "enum": [
        "NONE",
        "ENCRYPTED",
        "PLAIN"
      ],
      "default": "NONE",
      "description": " - NONE: No fine-timestamp available.\n - ENCRYPTED: Encrypted fine-timestamp.\n - PLAIN: Plain fine-timestamp."
    },
    "gwGatewayCommandExecResponse": {
      "type": "object",
      "properties": {
        "gatewayID": {
          "type": "string",
          "format": "byte",
          "description": "Gateway ID."
        },
        "execID": {
          "type": "string",
          "format": "byte",
          "description": "Execution request ID (UUID)."
        },
        "stdout": {
          "type": "string",
          "format": "byte",
          "description": "Standard output."
        },
        "stderr": {
          "type": "string",
          "format": "byte",
          "description": "Standard error."
        },
        "error": {
          "type": "string",
          "description": "Error message."
        }
      }
    },
    "hrDeviceFrameLog": {
      "type": "object",
      "properties": {
        "direction": {
          "type": "string",
          "title": "RX (uplink -recieved from devices) or TX (downlink - transmitted from NS)"
        },
        "dateTime": {
          "type": "string"
        },
        "date": {
          "type": "string"
        },
        "mType": {
          "type": "string"
        },
        "devAddr": {
          "type": "string"
        },
        "devEUI": {
          "type": "string"
        },
        "rxRssi": {
          "type": "integer",
          "format": "int32",
          "title": "params from base station with best SNR"
        },
        "rxSnr": {
          "type": "number",
          "format": "double"
        },
        "rxChannel": {
          "type": "integer",
          "format": "int64"
        },
        "rxRfChain": {
          "type": "integer",
          "format": "int64"
        },
        "gw": {
          "type": "string",
          "title": "id of base station with best SNR"
        },
        "txInfo": {
          "type": "string",
          "title": "json-string"
        },
        "rxInfo": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/hrRXInfo"
          },
          "title": "RXInfo an array with info from BS recieved the frame"
        },
        "PhyPayloadJson": {
          "type": "string",
          "title": "json-string with LORA payload"
        },
        "airtime": {
          "type": "number",
          "format": "double"
        },
        "esp": {
          "type": "number",
          "format": "double"
        },
        "late": {
          "type": "integer",
          "format": "int64"
        },
        "frmPayload": {
          "type": "string"
        },
        "FCntUp": {
          "type": "integer",
          "format": "int64",
          "title": "data from device-session"
        },
        "NFCntDown": {
          "type": "integer",
          "format": "int64"
        },
        "AFCntDown": {
          "type": "integer",
          "format": "int64"
        },
        "ConfFCnt": {
          "type": "integer",
          "format": "int64"
        },
        "spFact": {
          "type": "integer",
          "format": "int64",
          "title": "spreading factor (TxInfo)"
        }
      },
      "title": "for storage"
    },
    "hrExecCommandRequest": {
      "type": "object",
      "properties": {
        "gatewayId": {
          "type": "string",
          "description": "Gateway ID (HEX encoded)."
        },
        "command": {
          "type": "string",
          "title": "command that will be executed on gateway (according to the gw config)"
        },
        "timeout": {
          "type": "integer",
          "format": "int64",
          "title": "You can set timeout for the command execution. Default 30 seconds. Range 1-1000"
        },
        "backgroundTask": {
          "type": "boolean",
          "format": "boolean",
          "description": "Background task execution. If set true, the result will be saved in app-db.\n Allows to get large amount of data from devices asynchronously."
        }
      }
    },
    "hrFrameCounters": {
      "type": "object",
      "properties": {
        "date": {
          "type": "string",
          "format": "int64",
          "description": "Date: the metrics counted for."
        },
        "rxCnt": {
          "type": "integer",
          "format": "int64",
          "title": "RxCnt: total recieved frames counted"
        },
        "txCnt": {
          "type": "integer",
          "format": "int64",
          "title": "TxCnt: total transmitted frames counted"
        },
        "totalCnt": {
          "type": "integer",
          "format": "int64",
          "title": "TotalCnt: both TxCnt and RxCnt counted"
        },
        "unknownType": {
          "type": "integer",
          "format": "int64",
          "title": "UnknownType:"
        },
        "joinRequest": {
          "type": "integer",
          "format": "int64",
          "title": "JoinRequest"
        },
        "rejoinRequest": {
          "type": "integer",
          "format": "int64",
          "title": "RejoinRequest"
        },
        "joinAccept": {
          "type": "integer",
          "format": "int64",
          "title": "JoinAccept"
        },
        "unconfirmedDataUp": {
          "type": "integer",
          "format": "int64",
          "title": "UnconfirmedDataUp"
        },
        "unconfirmedDataDown": {
          "type": "integer",
          "format": "int64",
          "title": "UnconfirmedDataDown"
        },
        "confirmedDataUp": {
          "type": "integer",
          "format": "int64",
          "title": "ConfirmedDataUp"
        },
        "confirmedDataDown": {
          "type": "integer",
          "format": "int64",
          "title": "ConfirmedDataDown"
        },
        "proprietary": {
          "type": "integer",
          "format": "int64",
          "title": "Proprietary"
        }
      }
    },
    "hrFrameSpeed": {
      "type": "object",
      "properties": {
        "t": {
          "type": "string",
          "format": "int64",
          "title": "T: Created at timestamp (unix)"
        },
        "y": {
          "type": "integer",
          "format": "int64",
          "title": "Y: TotalCnt: both TxCnt and RxCnt frames counted for the amount of time"
        }
      }
    },
    "hrGetCurrentStateResponse": {
      "type": "object",
      "properties": {
        "wlLastPacket": {
          "type": "string",
          "title": "DateTime of last packet saved in wireless-loger"
        },
        "wlLastPacketUnix": {
          "type": "string",
          "format": "int64",
          "title": "the same as previuos in unixTime format"
        }
      }
    },
    "hrGetDeviceFramesLogRequest": {
      "type": "object",
      "properties": {
        "offset": {
          "type": "integer",
          "format": "int64",
          "title": "you can specify offset (for pagination)"
        },
        "limit": {
          "type": "integer",
          "format": "int64",
          "title": "you can specify rows limit"
        },
        "start": {
          "type": "string",
          "title": "You can specify start DateTime point. format RFC3339: 2006-01-02T15:04:05.000Z"
        },
        "end": {
          "type": "string",
          "title": "You can specify end DateTime point. format RFC3339: 2006-01-02T15:04:05.000Z"
        },
        "filters": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "Additional sql filters (key,value): allowed: direction,devEUI,mType,gw,devAddr"
        },
        "organizationId": {
          "type": "string",
          "format": "int64",
          "title": "You can set the id to 0 if admin"
        },
        "timezone": {
          "type": "string",
          "format": "int64",
          "description": "here user sends his local timezone."
        },
        "gwOnly": {
          "type": "boolean",
          "format": "boolean",
          "description": "for internal use. Will be ignored from external api."
        }
      }
    },
    "hrGetDeviceFramesLogResponse": {
      "type": "object",
      "properties": {
        "itemsTotal": {
          "type": "integer",
          "format": "int64",
          "title": "total numner of selected rows"
        },
        "data": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/hrDeviceFrameLog"
          },
          "title": "the array of selected device-frames logs"
        }
      }
    },
    "hrGetFrameCountersRequest": {
      "type": "object",
      "properties": {
        "start": {
          "type": "string",
          "title": "format RFC3339: 2006-01-02T15:04:05.000Z"
        },
        "end": {
          "type": "string",
          "title": "format RFC3339: 2006-01-02T15:04:05.000Z"
        }
      }
    },
    "hrGetFrameCountersResponse": {
      "type": "object",
      "properties": {
        "counters": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/hrFrameCounters"
          },
          "title": "list counters with frame counters by type"
        }
      }
    },
    "hrGetFrameSpeedRequest": {
      "type": "object",
      "properties": {
        "start": {
          "type": "string",
          "title": "format RFC3339: 2006-01-02T15:04:05.000Z"
        },
        "end": {
          "type": "string",
          "title": "format RFC3339: 2006-01-02T15:04:05.000Z"
        }
      }
    },
    "hrGetFrameSpeedResponse": {
      "type": "object",
      "properties": {
        "counters": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/hrFrameSpeed"
          },
          "title": "list counters with frames speed"
        }
      }
    },
    "hrGetIntegrationRepliesResponse": {
      "type": "object",
      "properties": {
        "itemsTotal": {
          "type": "integer",
          "format": "int64",
          "title": "total numner of selected rows"
        },
        "result": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/hrIntegrationReply"
          },
          "title": "the array of selected replies"
        }
      }
    },
    "hrIntegrationReply": {
      "type": "object",
      "properties": {
        "integrationUrl": {
          "type": "string",
          "title": "url from integration parameters where event informations sending"
        },
        "statusCode": {
          "type": "integer",
          "format": "int32",
          "title": "http status code of sent event (protobuf/as/integration/integration.proto)"
        },
        "statusCodeDescription": {
          "type": "string",
          "title": "description of http status code"
        },
        "applicationId": {
          "type": "string",
          "format": "int64",
          "title": "id of application where integration linked to"
        },
        "devEUI": {
          "type": "string",
          "format": "byte",
          "description": "Device EUI."
        },
        "time": {
          "type": "string",
          "format": "date-time",
          "title": "time of receining reply"
        }
      }
    },
    "hrRXInfo": {
      "type": "object",
      "properties": {
        "gateway_id": {
          "type": "string",
          "title": "GatewayID"
        },
        "rssi": {
          "type": "integer",
          "format": "int32"
        },
        "lora_snr": {
          "type": "number",
          "format": "double"
        },
        "channel": {
          "type": "integer",
          "format": "int64"
        },
        "rf_chain": {
          "type": "integer",
          "format": "int64"
        },
        "board": {
          "type": "integer",
          "format": "int64"
        },
        "antenna": {
          "type": "integer",
          "format": "int64"
        },
        "location": {
          "$ref": "#/definitions/commonLocation"
        },
        "FineTimestampType": {
          "$ref": "#/definitions/gwFineTimestampType"
        },
        "gps_timestamp": {
          "type": "string"
        },
        "fine_timestamp": {
          "type": "string"
        },
        "context": {
          "type": "string"
        },
        "uplink_id": {
          "type": "string",
          "description": "Unique and random ID which can be used to correlate the uplink across multiple logs."
        }
      },
      "title": "for RXInfo item in uplink frames"
    },
    "hrStreamDeviceFramesLogCSVResponse": {
      "type": "object",
      "properties": {
        "current": {
          "type": "integer",
          "format": "int64"
        },
        "total": {
          "type": "integer",
          "format": "int64"
        },
        "rows": {
          "type": "integer",
          "format": "int64"
        },
        "chunk": {
          "type": "string",
          "format": "byte"
        }
      }
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "typeUrl": {
          "type": "string"
        },
        "value": {
          "type": "string",
          "format": "byte"
        }
      }
    },
    "runtimeStreamError": {
      "type": "object",
      "properties": {
        "grpcCode": {
          "type": "integer",
          "format": "int32"
        },
        "httpCode": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "httpStatus": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    }
  },
  "x-stream-definitions": {
    "hrStreamDeviceFramesLogCSVResponse": {
      "type": "object",
      "properties": {
        "result": {
          "$ref": "#/definitions/hrStreamDeviceFramesLogCSVResponse"
        },
        "error": {
          "$ref": "#/definitions/runtimeStreamError"
        }
      },
      "title": "Stream result of hrStreamDeviceFramesLogCSVResponse"
    }
  }
}
